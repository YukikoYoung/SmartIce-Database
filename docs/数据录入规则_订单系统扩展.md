# é‡Žç™¾çµé¤é¥®é›†å›¢ - æ•°æ®å½•å…¥è§„åˆ™(è®¢å•ç³»ç»Ÿæ‰©å±•)

**ç‰ˆæœ¬**: v2.0.0-order-extension
**æ›´æ–°æ—¥æœŸ**: 2025-11-21
**é€‚ç”¨èŒƒå›´**: è®¢å•ç³»ç»Ÿæ‰©å±• + 16é¡¹è¿è¥æŒ‡æ ‡ + å¤šæ¸ é“é”€å”®
**å‰ç½®æ–‡æ¡£**: è¯·å…ˆé˜…è¯» `æ•°æ®å½•å…¥è§„åˆ™ä¸Žè¿ç§»æŒ‡å—.md`

---

## ðŸ“‘ ç›®å½•

1. [æ‰©å±•æ¦‚è¿°](#æ‰©å±•æ¦‚è¿°)
2. [æ–‡ä»¶5: POSè®¢å•æ˜Žç»†æ•°æ®](#æ–‡ä»¶5-posè®¢å•æ˜Žç»†æ•°æ®)
3. [æ–‡ä»¶6: ç»¼åˆè¥ä¸šç»Ÿè®¡æ•°æ®](#æ–‡ä»¶6-ç»¼åˆè¥ä¸šç»Ÿè®¡æ•°æ®)
4. [æ–‡ä»¶7: å¥—é¤å®šä¹‰æ•°æ®](#æ–‡ä»¶7-å¥—é¤å®šä¹‰æ•°æ®)
5. [æ–‡ä»¶8: å›¢è´­å¹³å°å¥—é¤æ•°æ®](#æ–‡ä»¶8-å›¢è´­å¹³å°å¥—é¤æ•°æ®)
6. [æ•°æ®å¯¼å…¥æµç¨‹](#æ•°æ®å¯¼å…¥æµç¨‹)
7. [16é¡¹è¿è¥æŒ‡æ ‡è¯´æ˜Ž](#16é¡¹è¿è¥æŒ‡æ ‡è¯´æ˜Ž)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æ‰©å±•æ¦‚è¿°

### æ–°å¢žåŠŸèƒ½

æ–¹æ¡ˆB(å®Œæ•´è®¢å•æ¨¡åž‹)æ‰©å±•äº†ä»¥ä¸‹åŠŸèƒ½:

1. **å®Œæ•´è®¢å•ç®¡ç†**
   - è®¢å•ä¸»è¡¨(sales_order): è®°å½•æ¯ç¬”è®¢å•çš„å®Œæ•´ä¿¡æ¯
   - è®¢å•æ˜Žç»†è¡¨(sales_order_item): è®°å½•è®¢å•ä¸­æ¯ä¸ªäº§å“
   - æ”¯æŒå ‚é£Ÿ/å¤–å–/å¤–å¸¦ä¸‰ç§è®¢å•ç±»åž‹

2. **å¤šæ¸ é“é”€å”®è·Ÿè¸ª**
   - é—¨åº—ç›´é”€
   - ç¾Žå›¢å¹³å°
   - æŠ–éŸ³å¹³å°
   - é¥¿äº†ä¹ˆå¹³å°
   - å¤§ä¼—ç‚¹è¯„

3. **å¥—é¤ä¸Žå›¢è´­ç®¡ç†**
   - å¥—é¤å®šä¹‰(product_package)
   - å›¢è´­å¹³å°ç®¡ç†(group_buy_platform)
   - å›¢è´­å¥—é¤æ´»åŠ¨(group_buy_deal)

4. **16é¡¹æ ¸å¿ƒè¿è¥æŒ‡æ ‡**
   - è®¢å•æ•°é‡ã€å°±é¤äººæ•°ã€å¼€å°æ•°
   - å¹³å‡å°±é¤æ—¶é•¿ã€ç¿»å°çŽ‡
   - äººå‡æ¶ˆè´¹ã€å®¢å•ä»·
   - é”€å”®é¢(æŠ˜å‰)ã€å®žæ”¶é‡‘é¢(æŠ˜åŽ)
   - æŠ˜æ‰£é‡‘é¢ã€æŠ˜æ‰£çŽ‡
   - äººå·¥æŠ˜æ‰£ã€ä¼˜æƒ åˆ¸æŠ˜æ‰£ã€ä¼šå‘˜æŠ˜æ‰£ã€æŠ¹é›¶

### æ–°å¢žè¡¨ç»“æž„

| è¡¨å | ç”¨é€” | æ•°æ®æ¥æº |
|------|------|---------|
| sales_order | è®¢å•ä¸»è¡¨ | POSç³»ç»Ÿè®¢å•æ˜Žç»† |
| sales_order_item | è®¢å•æ˜Žç»†è¡¨ | POSç³»ç»Ÿè®¢å•æ˜Žç»† |
| product_package | å¥—é¤å®šä¹‰ | æ‰‹åŠ¨å½•å…¥/å¯¼å…¥ |
| package_item | å¥—é¤æ˜Žç»† | æ‰‹åŠ¨å½•å…¥/å¯¼å…¥ |
| group_buy_platform | å›¢è´­å¹³å° | é¢„ç½®æ•°æ®(å·²å†…ç½®) |
| group_buy_deal | å›¢è´­å¥—é¤æ´»åŠ¨ | å¹³å°åŽå°å¯¼å‡º/æ‰‹åŠ¨å½•å…¥ |

---

## æ–‡ä»¶5: POSè®¢å•æ˜Žç»†æ•°æ®

### åŸºæœ¬ä¿¡æ¯

- **æ–‡ä»¶å**: `POSè®¢å•æ˜Žç»†_YYYYå¹´MMæœˆ.xlsx`
- **æ–‡ä»¶æ ¼å¼**: Excelå·¥ä½œç°¿(.xlsx)
- **Sheetåç§°**: `è®¢å•æ˜Žç»†` (å¿…é¡»æ˜¯æ­¤åç§°)
- **æ•°æ®è¡Œæ•°**: å»ºè®®å•æœˆ3,000-30,000è¡Œ
- **ç¼–ç æ ¼å¼**: UTF-8
- **æ•°æ®ç²’åº¦**: æ¯è¡Œä»£è¡¨ä¸€ä¸ªè®¢å•ä¸­çš„ä¸€ä¸ªäº§å“æ˜Žç»†

### å¿…å¡«å­—æ®µå®šä¹‰

#### è®¢å•ä¸»ä¿¡æ¯å­—æ®µ

| åˆ—åºå· | åˆ—å | æ•°æ®ç±»åž‹ | é•¿åº¦é™åˆ¶ | ç¤ºä¾‹å€¼ | æ˜¯å¦å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜Ž |
|-------|------|---------|---------|--------|---------|--------|------|
| A | è®¢å•ç¼–å· | æ–‡æœ¬ | 1-50å­—ç¬¦ | ORD-20251121-001 | âœ…å¿…å¡« | - | å”¯ä¸€è®¢å•å·,åŒä¸€è®¢å•çš„æ‰€æœ‰æ˜Žç»†è¡Œå¿…é¡»ç›¸åŒ |
| B | è®¢å•æ—¥æœŸ | æ—¥æœŸ | YYYY-MM-DD | 2025-11-21 | âœ…å¿…å¡« | - | è®¢å•æ—¥æœŸ |
| C | è®¢å•æ—¥æœŸæ—¶é—´ | æ—¥æœŸæ—¶é—´ | YYYY-MM-DD HH:MM:SS | 2025-11-21 12:30:45 | âœ…å¿…å¡« | - | ç²¾ç¡®ä¸‹å•æ—¶é—´ |
| D | è®¢å•ç±»åž‹ | æ–‡æœ¬ | - | å ‚é£Ÿ | âœ…å¿…å¡« | å ‚é£Ÿ | å ‚é£Ÿ/å¤–å–/å¤–å¸¦ |
| E | é”€å”®æ¸ é“ | æ–‡æœ¬ | 1-50å­—ç¬¦ | é—¨åº— | âœ…å¿…å¡« | é—¨åº— | é—¨åº—/ç¾Žå›¢/æŠ–éŸ³/é¥¿äº†ä¹ˆ |
| F | æ¡Œå· | æ–‡æœ¬ | 1-20å­—ç¬¦ | A08 | å¯é€‰ | - | å ‚é£Ÿå¿…å¡«,å¤–å–å¤–å¸¦å¯ä¸ºç©º |
| G | å°±é¤äººæ•° | æ•´æ•° | 1-99 | 4 | æŽ¨èå¡« | 1 | å°±é¤äººæ•° |
| H | å…¥åº§æ—¶é—´ | æ—¥æœŸæ—¶é—´ | YYYY-MM-DD HH:MM:SS | 2025-11-21 12:28:00 | å¯é€‰ | - | å ‚é£Ÿè®¢å•çš„å…¥åº§æ—¶é—´ |
| I | ç¦»åº§æ—¶é—´ | æ—¥æœŸæ—¶é—´ | YYYY-MM-DD HH:MM:SS | 2025-11-21 14:15:00 | å¯é€‰ | - | å ‚é£Ÿè®¢å•çš„ç¦»åº§æ—¶é—´ |
| J | æ”¯ä»˜æ–¹å¼ | æ–‡æœ¬ | - | å¾®ä¿¡æ”¯ä»˜ | âœ…å¿…å¡« | - | çŽ°é‡‘/å¾®ä¿¡/æ”¯ä»˜å®/åˆ·å¡/ä¼šå‘˜å¡ |
| K | å¹³å°è®¢å•å· | æ–‡æœ¬ | 1-100å­—ç¬¦ | MT202511210001 | å¯é€‰ | - | ç¬¬ä¸‰æ–¹å¹³å°çš„è®¢å•å· |

#### äº§å“æ˜Žç»†å­—æ®µ

| åˆ—åºå· | åˆ—å | æ•°æ®ç±»åž‹ | é•¿åº¦é™åˆ¶ | ç¤ºä¾‹å€¼ | æ˜¯å¦å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜Ž |
|-------|------|---------|---------|--------|---------|--------|------|
| L | äº§å“ç¼–ç  | æ–‡æœ¬ | 1-50å­—ç¬¦ | FIN-001 | âœ…å¿…å¡« | - | å¿…é¡»ä¸Žproductè¡¨ä¸­çš„product_codeåŒ¹é… |
| M | äº§å“åç§° | æ–‡æœ¬ | 1-200å­—ç¬¦ | äº‘å±±é›ªèŠ±åŠé¾™ | âœ…å¿…å¡« | - | ç”¨äºŽéªŒè¯,åº”ä¸Žproductè¡¨ä¸€è‡´ |
| N | æ•°é‡ | æ•°å€¼ | å°æ•°(10,2) | 2.00 | âœ…å¿…å¡« | - | é”€å”®æ•°é‡ |
| O | å•ä»·(åŽŸä»·) | æ•°å€¼ | å°æ•°(10,2) | 68.00 | âœ…å¿…å¡« | - | äº§å“åŽŸä»·(æŠ˜å‰) |
| P | æŠ˜æ‰£çŽ‡ | æ•°å€¼ | å°æ•°(5,4) | 0.10 | å¯é€‰ | 0.00 | æŠ˜æ‰£çŽ‡(0.10 = æ‰“9æŠ˜) |
| Q | å®žé™…å•ä»· | æ•°å€¼ | å°æ•°(10,2) | 61.20 | âœ…å¿…å¡« | - | æŠ˜åŽå®žé™…å•ä»· |
| R | æ˜¯å¦å¥—é¤ | æ–‡æœ¬ | - | å¦ | å¯é€‰ | å¦ | æ˜¯/å¦ |
| S | å¥—é¤ç¼–ç  | æ–‡æœ¬ | 1-50å­—ç¬¦ | PKG-001 | å¯é€‰ | - | å¦‚æžœæ˜¯å¥—é¤,å¡«å†™å¥—é¤ç¼–ç  |
| T | ç‰¹æ®Šè¦æ±‚ | æ–‡æœ¬ | 1-500å­—ç¬¦ | ä¸è¦é¦™èœ | å¯é€‰ | - | é¡¾å®¢çš„ç‰¹æ®Šè¦æ±‚ |

### æ•°æ®ç¤ºä¾‹

```
è®¢å•ç¼–å·          | è®¢å•æ—¥æœŸ   | è®¢å•æ—¥æœŸæ—¶é—´         | è®¢å•ç±»åž‹ | é”€å”®æ¸ é“ | æ¡Œå· | å°±é¤äººæ•° | å…¥åº§æ—¶é—´            | ç¦»åº§æ—¶é—´            | æ”¯ä»˜æ–¹å¼ | å¹³å°è®¢å•å· | äº§å“ç¼–ç  | äº§å“åç§°     | æ•°é‡ | å•ä»· | æŠ˜æ‰£çŽ‡ | å®žé™…å•ä»· | æ˜¯å¦å¥—é¤ | å¥—é¤ç¼–ç  | ç‰¹æ®Šè¦æ±‚
ORD-20251121-001 | 2025-11-21 | 2025-11-21 12:30:45 | å ‚é£Ÿ     | é—¨åº—     | A08  | 4        | 2025-11-21 12:28:00 | 2025-11-21 14:15:00 | å¾®ä¿¡æ”¯ä»˜ |            | FIN-001  | äº‘å±±é›ªèŠ±åŠé¾™ | 2.00 | 68.00 | 0.10   | 61.20    | å¦       |          | ä¸è¦é¦™èœ
ORD-20251121-001 | 2025-11-21 | 2025-11-21 12:30:45 | å ‚é£Ÿ     | é—¨åº—     | A08  | 4        | 2025-11-21 12:28:00 | 2025-11-21 14:15:00 | å¾®ä¿¡æ”¯ä»˜ |            | FIN-002  | è´µå·žé»„ç‰›è‚‰   | 1.00 | 78.00 | 0.10   | 70.20    | å¦       |          |
ORD-20251121-002 | 2025-11-21 | 2025-11-21 13:15:20 | å¤–å–     | ç¾Žå›¢     |      | 2        |                     |                     | åœ¨çº¿æ”¯ä»˜ | MT20251121001 | FIN-010  | æ‹›ç‰Œçƒ¤é±¼     | 1.00 | 88.00 | 0.00   | 88.00    | å¦       |          |
```

### æ•°æ®è§„åˆ™

#### 1. è®¢å•ç¼–ç è§„åˆ™
- **æ ¼å¼**: `ORD-YYYYMMDD-æµæ°´å·` æˆ– POSç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ
- **å”¯ä¸€æ€§**: æ¯ä¸ªè®¢å•å·å…¨å±€å”¯ä¸€
- **å…³è”æ€§**: åŒä¸€è®¢å•çš„æ‰€æœ‰äº§å“æ˜Žç»†å¿…é¡»ä½¿ç”¨ç›¸åŒçš„è®¢å•ç¼–å·

#### 2. è®¢å•ç±»åž‹æžšä¸¾å€¼
- `å ‚é£Ÿ`: åœ¨åº—å†…å°±é¤
- `å¤–å–`: å¹³å°é…é€(ç¾Žå›¢/é¥¿äº†ä¹ˆç­‰)
- `å¤–å¸¦`: é¡¾å®¢è‡ªå–

#### 3. é”€å”®æ¸ é“æžšä¸¾å€¼
- `é—¨åº—`: é—¨åº—ç›´æŽ¥é”€å”®
- `ç¾Žå›¢`: ç¾Žå›¢å¤–å–
- `æŠ–éŸ³`: æŠ–éŸ³å›¢è´­/å¤–å–
- `é¥¿äº†ä¹ˆ`: é¥¿äº†ä¹ˆå¤–å–
- `å¤§ä¼—ç‚¹è¯„`: å¤§ä¼—ç‚¹è¯„å›¢è´­

#### 4. æ”¯ä»˜æ–¹å¼æžšä¸¾å€¼
- `çŽ°é‡‘`: çŽ°é‡‘æ”¯ä»˜
- `å¾®ä¿¡æ”¯ä»˜`: å¾®ä¿¡æ‰«ç æ”¯ä»˜
- `æ”¯ä»˜å®`: æ”¯ä»˜å®æ‰«ç æ”¯ä»˜
- `åˆ·å¡`: é“¶è¡Œå¡åˆ·å¡
- `ä¼šå‘˜å¡`: ä¼šå‘˜ä½™é¢æ”¯ä»˜
- `å…¶ä»–`: å…¶ä»–æ”¯ä»˜æ–¹å¼

#### 5. é‡‘é¢è®¡ç®—è§„åˆ™
```
è¡Œå°è®¡(æŠ˜å‰) = æ•°é‡ Ã— å•ä»·(åŽŸä»·)
è¡ŒæŠ˜æ‰£é‡‘é¢ = è¡Œå°è®¡(æŠ˜å‰) Ã— æŠ˜æ‰£çŽ‡
è¡Œå®žæ”¶é‡‘é¢ = æ•°é‡ Ã— å®žé™…å•ä»·

éªŒè¯å…¬å¼:
å®žé™…å•ä»· â‰ˆ å•ä»·(åŽŸä»·) Ã— (1 - æŠ˜æ‰£çŽ‡)
```

#### 6. æ—¶é—´å­—æ®µè§„åˆ™
- **å…¥åº§æ—¶é—´ â‰¤ è®¢å•æ—¥æœŸæ—¶é—´**
- **è®¢å•æ—¥æœŸæ—¶é—´ â‰¤ ç¦»åº§æ—¶é—´**
- **å°±é¤æ—¶é•¿** = ç¦»åº§æ—¶é—´ - å…¥åº§æ—¶é—´(è‡ªåŠ¨è®¡ç®—,åˆ†é’Ÿ)

---

## æ–‡ä»¶6: ç»¼åˆè¥ä¸šç»Ÿè®¡æ•°æ®

### åŸºæœ¬ä¿¡æ¯

- **æ–‡ä»¶å**: `ç»¼åˆè¥ä¸šç»Ÿè®¡_YYYYå¹´MMæœˆ.xlsx`
- **æ–‡ä»¶æ ¼å¼**: Excelå·¥ä½œç°¿(.xlsx)
- **Sheetåç§°**: `ç»¼åˆè¥ä¸šç»Ÿè®¡`
- **æ•°æ®è¡Œæ•°**: æ¯æœˆ30-31è¡Œ(æ¯å¤©1è¡Œ)
- **ç¼–ç æ ¼å¼**: UTF-8
- **æ•°æ®ç²’åº¦**: æ¯è¡Œä»£è¡¨ä¸€å¤©çš„æ±‡æ€»æ•°æ®

> **è¯´æ˜Ž**: è¿™æ˜¯ä»ŽPOSç³»ç»Ÿå¯¼å‡ºçš„æ¯æ—¥æ±‡æ€»æ•°æ®,åŒ…å«16é¡¹è¿è¥æŒ‡æ ‡ã€‚å¦‚æžœæœ‰è®¢å•æ˜Žç»†æ•°æ®(æ–‡ä»¶5),å¯ä»¥ä¸å¯¼å…¥æ­¤æ–‡ä»¶,ç›´æŽ¥ä»Žè®¢å•æ˜Žç»†æ±‡æ€»ç”Ÿæˆã€‚

### å¿…å¡«å­—æ®µå®šä¹‰(16é¡¹æ ¸å¿ƒæŒ‡æ ‡)

| åˆ—åºå· | åˆ—å | æ•°æ®ç±»åž‹ | ç¤ºä¾‹å€¼ | æ˜¯å¦å¿…å¡« | è¯´æ˜Ž |
|-------|------|---------|--------|---------|------|
| A | æ—¥æœŸ | æ—¥æœŸ | 2025-11-21 | âœ…å¿…å¡« | è¥ä¸šæ—¥æœŸ |
| B | å•é‡ | æ•´æ•° | 125 | âœ…å¿…å¡« | â­æŒ‡æ ‡1: è®¢å•æ•°é‡ |
| C | äººæ•° | æ•´æ•° | 342 | âœ…å¿…å¡« | â­æŒ‡æ ‡2: å°±é¤äººæ•° |
| D | å¼€å°æ•° | æ•´æ•° | 98 | æŽ¨èå¡« | â­æŒ‡æ ‡3: å ‚é£Ÿå¼€å°æ•° |
| E | å¹³å‡ç”¨é¤æ—¶é•¿(åˆ†é’Ÿ) | æ•°å€¼ | 87.5 | æŽ¨èå¡« | â­æŒ‡æ ‡4: å¹³å‡å°±é¤æ—¶é•¿ |
| F | å¹³å‡ç”¨é¤äººæ•° | æ•°å€¼ | 2.74 | æŽ¨èå¡« | â­æŒ‡æ ‡5: å¹³å‡æ¯å•äººæ•° |
| G | äººå‡æ¶ˆè´¹(å…ƒ) | æ•°å€¼ | 58.23 | æŽ¨èå¡« | â­æŒ‡æ ‡6: äººå‡æ¶ˆè´¹ = å®žæ”¶é‡‘é¢/äººæ•° |
| H | å®¢å•ä»·(å…ƒ) | æ•°å€¼ | 159.50 | æŽ¨èå¡« | â­æŒ‡æ ‡7: å®¢å•ä»· = å®žæ”¶é‡‘é¢/å•é‡ |
| I | ç¿»å°çŽ‡ | æ•°å€¼ | 1.28 | æŽ¨èå¡« | â­æŒ‡æ ‡8: ç¿»å°çŽ‡(ä»…å ‚é£Ÿ) |
| J | é”€å”®é¢(æŠ˜å‰) | æ•°å€¼ | 21500.00 | âœ…å¿…å¡« | â­æŒ‡æ ‡9: æŠ˜å‰é”€å”®é¢ |
| K | å®žæ”¶é‡‘é¢(æŠ˜åŽ) | æ•°å€¼ | 19937.50 | âœ…å¿…å¡« | â­æŒ‡æ ‡10: å®žæ”¶é‡‘é¢ |
| L | æŠ˜æ‰£é‡‘é¢ | æ•°å€¼ | 1562.50 | âœ…å¿…å¡« | â­æŒ‡æ ‡11: æ€»æŠ˜æ‰£é‡‘é¢ |
| M | æŠ˜æ‰£çŽ‡(%) | æ•°å€¼ | 7.27 | æŽ¨èå¡« | â­æŒ‡æ ‡12: æŠ˜æ‰£çŽ‡ = æŠ˜æ‰£é‡‘é¢/é”€å”®é¢Ã—100% |
| N | äººå·¥æŠ˜æ‰£ | æ•°å€¼ | 500.00 | æŽ¨èå¡« | â­æŒ‡æ ‡13: äººå·¥æŠ˜æ‰£é‡‘é¢ |
| O | ä¼˜æƒ åˆ¸æŠ˜æ‰£ | æ•°å€¼ | 800.00 | æŽ¨èå¡« | â­æŒ‡æ ‡14: ä¼˜æƒ åˆ¸æŠ˜æ‰£é‡‘é¢ |
| P | ä¼šå‘˜æŠ˜æ‰£ | æ•°å€¼ | 200.00 | æŽ¨èå¡« | â­æŒ‡æ ‡15: ä¼šå‘˜æŠ˜æ‰£é‡‘é¢ |
| Q | æŠ¹é›¶ | æ•°å€¼ | 62.50 | æŽ¨èå¡« | â­æŒ‡æ ‡16: æŠ¹é›¶é‡‘é¢ |

### æ‰©å±•å­—æ®µ(æ”¯ä»˜æ¸ é“åˆ†æž)

| åˆ—åºå· | åˆ—å | æ•°æ®ç±»åž‹ | ç¤ºä¾‹å€¼ | æ˜¯å¦å¿…å¡« | è¯´æ˜Ž |
|-------|------|---------|--------|---------|------|
| R | çŽ°é‡‘æ”¶å…¥ | æ•°å€¼ | 1200.00 | å¯é€‰ | çŽ°é‡‘æ”¯ä»˜é‡‘é¢ |
| S | å¾®ä¿¡æ”¶å…¥ | æ•°å€¼ | 12500.00 | å¯é€‰ | å¾®ä¿¡æ”¯ä»˜é‡‘é¢ |
| T | æ”¯ä»˜å®æ”¶å…¥ | æ•°å€¼ | 5000.00 | å¯é€‰ | æ”¯ä»˜å®æ”¯ä»˜é‡‘é¢ |
| U | åˆ·å¡æ”¶å…¥ | æ•°å€¼ | 1000.00 | å¯é€‰ | åˆ·å¡æ”¯ä»˜é‡‘é¢ |
| V | ä¼šå‘˜å¡æ”¶å…¥ | æ•°å€¼ | 237.50 | å¯é€‰ | ä¼šå‘˜å¡æ”¯ä»˜é‡‘é¢ |
| W | ç¾Žå›¢å›¢è´­æ ¸é”€ | æ•°å€¼ | 3500.00 | å¯é€‰ | ç¾Žå›¢å›¢è´­åˆ¸æ ¸é”€é‡‘é¢ |
| X | æŠ–éŸ³å›¢è´­æ ¸é”€ | æ•°å€¼ | 2800.00 | å¯é€‰ | æŠ–éŸ³å›¢è´­åˆ¸æ ¸é”€é‡‘é¢ |

### æ•°æ®ç¤ºä¾‹

```
æ—¥æœŸ       | å•é‡ | äººæ•° | å¼€å°æ•° | å¹³å‡ç”¨é¤æ—¶é•¿ | å¹³å‡ç”¨é¤äººæ•° | äººå‡æ¶ˆè´¹ | å®¢å•ä»·  | ç¿»å°çŽ‡ | é”€å”®é¢  | å®žæ”¶é‡‘é¢ | æŠ˜æ‰£é‡‘é¢ | æŠ˜æ‰£çŽ‡ | äººå·¥æŠ˜æ‰£ | ä¼˜æƒ åˆ¸æŠ˜æ‰£ | ä¼šå‘˜æŠ˜æ‰£ | æŠ¹é›¶  | çŽ°é‡‘æ”¶å…¥ | å¾®ä¿¡æ”¶å…¥  | æ”¯ä»˜å®æ”¶å…¥ | åˆ·å¡æ”¶å…¥ | ä¼šå‘˜å¡æ”¶å…¥ | ç¾Žå›¢å›¢è´­æ ¸é”€ | æŠ–éŸ³å›¢è´­æ ¸é”€
2025-11-21 | 125  | 342  | 98     | 87.5         | 2.74         | 58.23    | 159.50  | 1.28   | 21500.00| 19937.50 | 1562.50  | 7.27   | 500.00   | 800.00     | 200.00   | 62.50 | 1200.00  | 12500.00  | 5000.00    | 1000.00  | 237.50     | 3500.00      | 2800.00
2025-11-22 | 138  | 378  | 105    | 92.3         | 2.74         | 61.45    | 168.50  | 1.31   | 24800.00| 23230.00 | 1570.00  | 6.33   | 600.00   | 700.00     | 220.00   | 50.00 | 1500.00  | 14000.00  | 5500.00    | 1200.00  | 1030.00    | 3800.00      | 3200.00
```

### æ•°æ®éªŒè¯å…¬å¼

åœ¨Excelä¸­å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å…¬å¼éªŒè¯æ•°æ®ä¸€è‡´æ€§:

```excel
=IF(ABS(J-K-L)>0.01, "âŒæŠ˜æ‰£é‡‘é¢ä¸åŒ¹é…", "âœ“")
=IF(ABS(M-L/J*100)>0.1, "âŒæŠ˜æ‰£çŽ‡è®¡ç®—é”™è¯¯", "âœ“")
=IF(ABS(G-K/C)>0.1, "âŒäººå‡æ¶ˆè´¹è®¡ç®—é”™è¯¯", "âœ“")
=IF(ABS(H-K/B)>0.1, "âŒå®¢å•ä»·è®¡ç®—é”™è¯¯", "âœ“")
=IF(ABS(K-(R+S+T+U+V))>0.1, "âŒæ”¯ä»˜é‡‘é¢ä¸åŒ¹é…", "âœ“")
```

---

## æ–‡ä»¶7: å¥—é¤å®šä¹‰æ•°æ®

### åŸºæœ¬ä¿¡æ¯

- **æ–‡ä»¶å**: `å¥—é¤å®šä¹‰.xlsx`
- **æ–‡ä»¶æ ¼å¼**: Excelå·¥ä½œç°¿(.xlsx)
- **åŒ…å«Sheet**: 2ä¸ªSheet
  - Sheet1: `å¥—é¤ä¸»è¡¨` - å¥—é¤åŸºæœ¬ä¿¡æ¯
  - Sheet2: `å¥—é¤æ˜Žç»†` - å¥—é¤åŒ…å«çš„äº§å“
- **æ•°æ®è¡Œæ•°**: å»ºè®®10-50ä¸ªå¥—é¤
- **ç¼–ç æ ¼å¼**: UTF-8

### Sheet1: å¥—é¤ä¸»è¡¨

| åˆ—åºå· | åˆ—å | æ•°æ®ç±»åž‹ | é•¿åº¦é™åˆ¶ | ç¤ºä¾‹å€¼ | æ˜¯å¦å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜Ž |
|-------|------|---------|---------|--------|---------|--------|------|
| A | å¥—é¤ç¼–ç  | æ–‡æœ¬ | 1-50å­—ç¬¦ | PKG-001 | âœ…å¿…å¡« | - | å”¯ä¸€å¥—é¤ç¼–ç ,å»ºè®®æ ¼å¼:PKG-XXX |
| B | å¥—é¤åç§° | æ–‡æœ¬ | 1-200å­—ç¬¦ | åŒäººé…¸æ±¤å¥—é¤ | âœ…å¿…å¡« | - | å¥—é¤åç§° |
| C | å“ç±» | æ–‡æœ¬ | 1-100å­—ç¬¦ | å¥—é¤ | æŽ¨èå¡« | å¥—é¤ | å“ç±»åç§° |
| D | å¥—é¤å”®ä»· | æ•°å€¼ | å°æ•°(10,2) | 168.00 | âœ…å¿…å¡« | - | å¥—é¤ä¼˜æƒ ä»· |
| E | åŽŸä»·åˆè®¡ | æ•°å€¼ | å°æ•°(10,2) | 218.00 | æŽ¨èå¡« | - | å•å“åŽŸä»·åŠ æ€» |
| F | ä¼˜æƒ é‡‘é¢ | æ•°å€¼ | å°æ•°(10,2) | 50.00 | æŽ¨èå¡« | - | å¥—é¤ä¼˜æƒ é‡‘é¢ = åŽŸä»·-å”®ä»· |
| G | æœ‰æ•ˆæœŸå¼€å§‹ | æ—¥æœŸ | YYYY-MM-DD | 2025-11-01 | æŽ¨èå¡« | - | å¥—é¤ç”Ÿæ•ˆæ—¥æœŸ |
| H | æœ‰æ•ˆæœŸç»“æŸ | æ—¥æœŸ | YYYY-MM-DD | 2025-12-31 | æŽ¨èå¡« | - | å¥—é¤å¤±æ•ˆæ—¥æœŸ |
| I | æ¯æ—¥é™å”® | æ•´æ•° | 1-999 | 20 | å¯é€‰ | - | æ¯æ—¥é™å”®æ•°é‡ |
| J | æ˜¯å¦ä¸Šçº¿ | æ–‡æœ¬ | - | æ˜¯ | âœ…å¿…å¡« | æ˜¯ | æ˜¯/å¦ |

### Sheet2: å¥—é¤æ˜Žç»†

| åˆ—åºå· | åˆ—å | æ•°æ®ç±»åž‹ | é•¿åº¦é™åˆ¶ | ç¤ºä¾‹å€¼ | æ˜¯å¦å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜Ž |
|-------|------|---------|---------|--------|---------|--------|------|
| A | å¥—é¤ç¼–ç  | æ–‡æœ¬ | 1-50å­—ç¬¦ | PKG-001 | âœ…å¿…å¡« | - | å…³è”å¥—é¤ä¸»è¡¨ |
| B | äº§å“ç¼–ç  | æ–‡æœ¬ | 1-50å­—ç¬¦ | FIN-001 | âœ…å¿…å¡« | - | å…³è”productè¡¨ |
| C | äº§å“åç§° | æ–‡æœ¬ | 1-200å­—ç¬¦ | äº‘å±±é›ªèŠ±åŠé¾™ | âœ…å¿…å¡« | - | ç”¨äºŽéªŒè¯ |
| D | æ•°é‡ | æ•°å€¼ | å°æ•°(10,2) | 1.00 | âœ…å¿…å¡« | 1.00 | å¥—é¤åŒ…å«æ•°é‡ |
| E | æ˜¯å¦å¯é€‰ | æ–‡æœ¬ | - | å¦ | å¯é€‰ | å¦ | æ˜¯å¦å¯é€‰é…(æ˜¯/å¦) |
| F | æ˜¯å¦ä¸»æ‰“ | æ–‡æœ¬ | - | æ˜¯ | å¯é€‰ | å¦ | æ˜¯å¦ä¸»æ‰“äº§å“(æ˜¯/å¦) |
| G | æ˜¾ç¤ºé¡ºåº | æ•´æ•° | 1-99 | 1 | å¯é€‰ | 0 | æ˜¾ç¤ºé¡ºåº |

### æ•°æ®ç¤ºä¾‹

**å¥—é¤ä¸»è¡¨**:
```
å¥—é¤ç¼–ç   | å¥—é¤åç§°       | å“ç±» | å¥—é¤å”®ä»· | åŽŸä»·åˆè®¡ | ä¼˜æƒ é‡‘é¢ | æœ‰æ•ˆæœŸå¼€å§‹ | æœ‰æ•ˆæœŸç»“æŸ | æ¯æ—¥é™å”® | æ˜¯å¦ä¸Šçº¿
PKG-001  | åŒäººé…¸æ±¤å¥—é¤   | å¥—é¤ | 168.00   | 218.00   | 50.00    | 2025-11-01 | 2025-12-31 | 20       | æ˜¯
PKG-002  | å®¶åº­æ¬¢èšå¥—é¤   | å¥—é¤ | 388.00   | 488.00   | 100.00   | 2025-11-01 | 2025-12-31 | 10       | æ˜¯
```

**å¥—é¤æ˜Žç»†**:
```
å¥—é¤ç¼–ç   | äº§å“ç¼–ç  | äº§å“åç§°     | æ•°é‡ | æ˜¯å¦å¯é€‰ | æ˜¯å¦ä¸»æ‰“ | æ˜¾ç¤ºé¡ºåº
PKG-001  | FIN-001  | äº‘å±±é›ªèŠ±åŠé¾™ | 1.00 | å¦       | æ˜¯       | 1
PKG-001  | FIN-005  | é…¸æ±¤è‚¥ç‰›     | 1.00 | å¦       | æ˜¯       | 2
PKG-001  | FIN-020  | æ—¶ä»¤è”¬èœæ‹¼ç›˜ | 1.00 | å¦       | å¦       | 3
PKG-002  | FIN-001  | äº‘å±±é›ªèŠ±åŠé¾™ | 2.00 | å¦       | æ˜¯       | 1
PKG-002  | FIN-002  | è´µå·žé»„ç‰›è‚‰   | 1.00 | å¦       | æ˜¯       | 2
PKG-002  | FIN-010  | æ‹›ç‰Œçƒ¤é±¼     | 1.00 | å¦       | æ˜¯       | 3
```

---

## æ–‡ä»¶8: å›¢è´­å¹³å°å¥—é¤æ•°æ®

### åŸºæœ¬ä¿¡æ¯

- **æ–‡ä»¶å**: `å›¢è´­å¥—é¤æ´»åŠ¨.xlsx`
- **æ–‡ä»¶æ ¼å¼**: Excelå·¥ä½œç°¿(.xlsx)
- **Sheetåç§°**: `å›¢è´­å¥—é¤`
- **æ•°æ®è¡Œæ•°**: å»ºè®®10-100ä¸ªå›¢è´­æ´»åŠ¨
- **ç¼–ç æ ¼å¼**: UTF-8

> **è¯´æ˜Ž**: è®°å½•åœ¨ç¾Žå›¢/æŠ–éŸ³ç­‰å¹³å°ä¸Šçº¿çš„å›¢è´­å¥—é¤æ´»åŠ¨

### å¿…å¡«å­—æ®µå®šä¹‰

| åˆ—åºå· | åˆ—å | æ•°æ®ç±»åž‹ | é•¿åº¦é™åˆ¶ | ç¤ºä¾‹å€¼ | æ˜¯å¦å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜Ž |
|-------|------|---------|---------|--------|---------|--------|------|
| A | å›¢è´­ç¼–ç  | æ–‡æœ¬ | 1-50å­—ç¬¦ | GB-MT-001 | âœ…å¿…å¡« | - | å”¯ä¸€å›¢è´­æ´»åŠ¨ç¼–ç  |
| B | å›¢è´­åç§° | æ–‡æœ¬ | 1-200å­—ç¬¦ | ç¾Žå›¢åŒäººå¥—é¤ | âœ…å¿…å¡« | - | å›¢è´­æ´»åŠ¨åç§° |
| C | å¹³å° | æ–‡æœ¬ | - | ç¾Žå›¢ | âœ…å¿…å¡« | - | ç¾Žå›¢/æŠ–éŸ³/é¥¿äº†ä¹ˆ/å¤§ä¼—ç‚¹è¯„ |
| D | å¹³å°æ´»åŠ¨ID | æ–‡æœ¬ | 1-100å­—ç¬¦ | MT2025110001 | æŽ¨èå¡« | - | å¹³å°ä¾§çš„å›¢è´­ID |
| E | é€‚ç”¨é—¨åº— | æ–‡æœ¬ | 1-200å­—ç¬¦ | å…¨éƒ¨é—¨åº— | âœ…å¿…å¡« | - | å…¨éƒ¨é—¨åº—/é‡Žç™¾çµå¾·é˜³åº—/... |
| F | å…³è”å¥—é¤ç¼–ç  | æ–‡æœ¬ | 1-50å­—ç¬¦ | PKG-001 | æŽ¨èå¡« | - | å…³è”å¥—é¤å®šä¹‰è¡¨ |
| G | é—¨åº—åŽŸä»· | æ•°å€¼ | å°æ•°(10,2) | 218.00 | âœ…å¿…å¡« | - | é—¨åº—å•ç‚¹åŽŸä»· |
| H | å›¢è´­ä»· | æ•°å€¼ | å°æ•°(10,2) | 168.00 | âœ…å¿…å¡« | - | å›¢è´­å”®ä»· |
| I | ä¼˜æƒ é‡‘é¢ | æ•°å€¼ | å°æ•°(10,2) | 50.00 | æŽ¨èå¡« | - | ä¼˜æƒ é‡‘é¢ = åŽŸä»·-å›¢è´­ä»· |
| J | å¹³å°ä½£é‡‘çŽ‡(%) | æ•°å€¼ | å°æ•°(5,2) | 8.00 | âœ…å¿…å¡« | - | ç¾Žå›¢8%, æŠ–éŸ³6% |
| K | æ¯äººé™è´­ | æ•´æ•° | 1-99 | 2 | å¯é€‰ | - | æ¯äººé™è´­æ•°é‡ |
| L | æ¯æ—¥åº“å­˜ | æ•´æ•° | 1-9999 | 50 | æŽ¨èå¡« | - | æ¯æ—¥ä¾›åº”æ•°é‡ |
| M | æ€»åº“å­˜ | æ•´æ•° | 1-99999 | 1000 | æŽ¨èå¡« | - | æ´»åŠ¨æ€»åº“å­˜ |
| N | å·²å”®æ•°é‡ | æ•´æ•° | 0-99999 | 327 | å¯é€‰ | 0 | å·²å”®å‡ºæ•°é‡ |
| O | å¼€å§‹æ—¥æœŸ | æ—¥æœŸ | YYYY-MM-DD | 2025-11-01 | âœ…å¿…å¡« | - | æ´»åŠ¨å¼€å§‹æ—¥æœŸ |
| P | ç»“æŸæ—¥æœŸ | æ—¥æœŸ | YYYY-MM-DD | 2025-12-31 | âœ…å¿…å¡« | - | æ´»åŠ¨ç»“æŸæ—¥æœŸ |
| Q | æ˜¯å¦éœ€é¢„çº¦ | æ–‡æœ¬ | - | æ˜¯ | å¯é€‰ | å¦ | æ˜¯å¦éœ€è¦æå‰é¢„çº¦(æ˜¯/å¦) |
| R | æ´»åŠ¨çŠ¶æ€ | æ–‡æœ¬ | - | è¿›è¡Œä¸­ | âœ…å¿…å¡« | è¿›è¡Œä¸­ | è¿›è¡Œä¸­/æš‚åœ/å·²å”®ç½„/å·²ç»“æŸ |

### æ•°æ®ç¤ºä¾‹

```
å›¢è´­ç¼–ç     | å›¢è´­åç§°         | å¹³å°   | å¹³å°æ´»åŠ¨ID    | é€‚ç”¨é—¨åº—     | å…³è”å¥—é¤ç¼–ç  | é—¨åº—åŽŸä»· | å›¢è´­ä»· | ä¼˜æƒ é‡‘é¢ | å¹³å°ä½£é‡‘çŽ‡ | æ¯äººé™è´­ | æ¯æ—¥åº“å­˜ | æ€»åº“å­˜ | å·²å”®æ•°é‡ | å¼€å§‹æ—¥æœŸ   | ç»“æŸæ—¥æœŸ   | æ˜¯å¦éœ€é¢„çº¦ | æ´»åŠ¨çŠ¶æ€
GB-MT-001  | ç¾Žå›¢åŒäººå¥—é¤     | ç¾Žå›¢   | MT2025110001 | å…¨éƒ¨é—¨åº—     | PKG-001      | 218.00   | 168.00 | 50.00    | 8.00       | 2        | 50       | 1000   | 327      | 2025-11-01 | 2025-12-31 | æ˜¯         | è¿›è¡Œä¸­
GB-DY-001  | æŠ–éŸ³åŒäººå¥—é¤     | æŠ–éŸ³   | DY2025110001 | å…¨éƒ¨é—¨åº—     | PKG-001      | 218.00   | 158.00 | 60.00    | 6.00       | 2        | 30       | 500    | 189      | 2025-11-01 | 2025-12-31 | å¦         | è¿›è¡Œä¸­
GB-MT-002  | ç¾Žå›¢å®¶åº­å¥—é¤     | ç¾Žå›¢   | MT2025110002 | é‡Žç™¾çµå¾·é˜³åº— | PKG-002      | 488.00   | 388.00 | 100.00   | 8.00       | 1        | 10       | 200    | 56       | 2025-11-01 | 2025-12-31 | æ˜¯         | è¿›è¡Œä¸­
```

---

## æ•°æ®å¯¼å…¥æµç¨‹

### æ–¹å¼1: ä½¿ç”¨Python ETLè„šæœ¬(æŽ¨è)

```bash
# 1. å¯¼å…¥è®¢å•æ˜Žç»†æ•°æ®
python3 etl_excel_to_order_system.py \
    --action import_orders \
    --file "POSè®¢å•æ˜Žç»†_2025å¹´11æœˆ.xlsx" \
    --store-id 1

# 2. å¯¼å…¥å¥—é¤å®šä¹‰
python3 etl_excel_to_order_system.py \
    --action import_packages \
    --file "å¥—é¤å®šä¹‰.xlsx"

# 3. å¯¼å…¥å›¢è´­æ´»åŠ¨
python3 etl_excel_to_order_system.py \
    --action import_groupbuy \
    --file "å›¢è´­å¥—é¤æ´»åŠ¨.xlsx"
```

### æ–¹å¼2: æ‰‹åŠ¨SQLå¯¼å…¥

```sql
-- 1. å¯¼å…¥è®¢å•ä¸»è¡¨(ç¤ºä¾‹)
INSERT INTO sales_order (
    order_code, store_id, order_date, order_datetime,
    order_type, sales_channel, table_number, guest_count,
    subtotal_amount, discount_amount, final_amount,
    payment_method, order_status
) VALUES (
    'ORD-20251121-001', 1, '2025-11-21', '2025-11-21 12:30:45',
    'dine_in', 'store', 'A08', 4,
    500.00, 50.00, 450.00,
    'wechat', 'completed'
);

-- 2. å¯¼å…¥è®¢å•æ˜Žç»†(éœ€å…ˆèŽ·å–order_id)
INSERT INTO sales_order_item (
    order_id, product_id, product_code, product_name,
    quantity, unit_price, discount_rate, actual_price,
    line_subtotal, line_discount, line_total
) VALUES (
    1, 101, 'FIN-001', 'äº‘å±±é›ªèŠ±åŠé¾™',
    2.00, 68.00, 0.10, 61.20,
    136.00, 13.60, 122.40
);
```

### SQLæ‰§è¡Œé¡ºåº

```bash
# æ–¹æ¡ˆBå®Œæ•´å®‰è£…é¡ºåº:
psql ybl_restaurant -f schema_core_mvp.sql                    # 1. æ ¸å¿ƒè¡¨ç»“æž„
psql ybl_restaurant -f functions_cost_encryption.sql          # 2. åŠ å¯†å‡½æ•°
psql ybl_restaurant -f functions_bom_explosion.sql            # 3. BOMåˆ†è§£å‡½æ•°
psql ybl_restaurant -f triggers_automatic_calculation.sql     # 4. è§¦å‘å™¨
psql ybl_restaurant -f procedures_data_validation.sql         # 5. éªŒè¯å­˜å‚¨è¿‡ç¨‹
psql ybl_restaurant -f data_init_mvp.sql                      # 6. åˆå§‹æ•°æ®(å•ä½/å“ç±»)
psql ybl_restaurant -f schema_extension_order_system.sql      # 7. â­è®¢å•ç³»ç»Ÿæ‰©å±•(6å¼ æ–°è¡¨)
psql ybl_restaurant -f views_financial_analysis.sql           # 8. è´¢åŠ¡åˆ†æžè§†å›¾
psql ybl_restaurant -f views_operations_kpi.sql               # 9. â­è¿è¥KPIè§†å›¾(16é¡¹æŒ‡æ ‡)
```

---

## 16é¡¹è¿è¥æŒ‡æ ‡è¯´æ˜Ž

### æ ¸å¿ƒæŒ‡æ ‡å®šä¹‰

| åºå· | æŒ‡æ ‡åç§° | è‹±æ–‡å | è®¡ç®—å…¬å¼ | æ•°æ®æ¥æºè¡¨ | ä¸šåŠ¡æ„ä¹‰ |
|-----|---------|--------|---------|-----------|---------|
| 1 | è®¢å•æ•°é‡ | order_count | COUNT(DISTINCT order_id) | sales_order | è¡¡é‡è¥ä¸šç¹å¿™ç¨‹åº¦ |
| 2 | å°±é¤äººæ•° | total_guest_count | SUM(guest_count) | sales_order | å®¢æµé‡æŒ‡æ ‡ |
| 3 | å¼€å°æ•° | table_count | COUNT(DISTINCT table_number) WHERE order_type='dine_in' | sales_order | å ‚é£Ÿæ¡Œå°åˆ©ç”¨æƒ…å†µ |
| 4 | å¹³å‡å°±é¤æ—¶é•¿ | avg_dining_duration | AVG(dining_duration_minutes) | sales_order | ç¿»å°æ•ˆçŽ‡æŒ‡æ ‡ |
| 5 | å¹³å‡ç”¨é¤äººæ•° | avg_guest_count | AVG(guest_count) | sales_order | è®¢å•è§„æ¨¡ |
| 6 | äººå‡æ¶ˆè´¹ | per_capita_spending | SUM(final_amount) / SUM(guest_count) | sales_order | å®¢æˆ·ä»·å€¼æŒ‡æ ‡ |
| 7 | å®¢å•ä»· | avg_order_value | AVG(final_amount) | sales_order | è®¢å•ä»·å€¼æŒ‡æ ‡ |
| 8 | ç¿»å°çŽ‡ | table_turnover_rate | è®¢å•æ•° / å¼€å°æ•° | sales_order | æ¡Œå°å‘¨è½¬æ•ˆçŽ‡ |
| 9 | é”€å”®é¢(æŠ˜å‰) | total_presales | SUM(subtotal_amount) | sales_order | æŠ˜å‰æ€»æ”¶å…¥ |
| 10 | å®žæ”¶é‡‘é¢(æŠ˜åŽ) | total_final_amount | SUM(final_amount) | sales_order | â­å®žé™…æ”¶å…¥(æ ¸å¿ƒ) |
| 11 | æŠ˜æ‰£é‡‘é¢ | total_discount | SUM(discount_amount) | sales_order | ä¿ƒé”€æˆæœ¬ |
| 12 | æŠ˜æ‰£çŽ‡ | discount_rate | SUM(discount_amount)/SUM(subtotal_amount)Ã—100% | sales_order | ä¿ƒé”€åŠ›åº¦ |
| 13 | äººå·¥æŠ˜æ‰£ | manual_discount | SUM(manual_discount) | sales_order | äººå·¥ä¼˜æƒ é‡‘é¢ |
| 14 | ä¼˜æƒ åˆ¸æŠ˜æ‰£ | coupon_discount | SUM(coupon_discount) | sales_order | ä¼˜æƒ åˆ¸æˆæœ¬ |
| 15 | ä¼šå‘˜æŠ˜æ‰£ | membership_discount | SUM(membership_discount) | sales_order | ä¼šå‘˜ä¼˜æƒ æˆæœ¬ |
| 16 | æŠ¹é›¶ | rounding_amount | SUM(rounding_amount) | sales_order | æŠ¹é›¶é‡‘é¢ |

### æŸ¥è¯¢ç¤ºä¾‹

```sql
-- æŸ¥è¯¢æŸé—¨åº—æŸæœˆçš„16é¡¹è¿è¥æŒ‡æ ‡
SELECT * FROM v_store_daily_operations
WHERE store_id = 1
  AND order_date >= '2025-11-01'
  AND order_date < '2025-12-01'
ORDER BY order_date DESC;

-- å¯¹æ¯”ä¸åŒæ¸ é“çš„é”€å”®æƒ…å†µ
SELECT
    sales_channel,
    COUNT(*) AS order_count,
    SUM(final_amount) AS total_revenue,
    AVG(final_amount) AS avg_order_value
FROM sales_order
WHERE order_date >= '2025-11-01'
  AND order_status = 'completed'
GROUP BY sales_channel;

-- åˆ†æžå¹³å°ä½£é‡‘æƒ…å†µ(ç¾Žå›¢ vs æŠ–éŸ³)
SELECT * FROM v_platform_groupbuy_summary
WHERE order_date >= '2025-11-01'
  AND order_date < '2025-12-01'
ORDER BY total_revenue DESC;
```

---

## å¸¸è§é—®é¢˜

### Q1: ç»¼åˆè¥ä¸šç»Ÿè®¡æ•°æ®å’Œè®¢å•æ˜Žç»†æ•°æ®æœ‰ä»€ä¹ˆåŒºåˆ«?

**A**:
- **ç»¼åˆè¥ä¸šç»Ÿè®¡**: POSç³»ç»Ÿå¯¼å‡ºçš„æ¯æ—¥æ±‡æ€»æ•°æ®,æ¯å¤©1è¡Œ,åŒ…å«16é¡¹æŒ‡æ ‡
- **è®¢å•æ˜Žç»†**: æ¯ç¬”è®¢å•çš„è¯¦ç»†è®°å½•,æ¯ä¸ªè®¢å•ä¸­çš„æ¯ä¸ªäº§å“1è¡Œ

**æŽ¨è**: ä¼˜å…ˆå¯¼å…¥è®¢å•æ˜Žç»†æ•°æ®,ç³»ç»Ÿä¼šè‡ªåŠ¨æ±‡æ€»ç”Ÿæˆ16é¡¹æŒ‡æ ‡ã€‚å¦‚æžœæ²¡æœ‰è®¢å•æ˜Žç»†,ä¹Ÿå¯ä»¥ç›´æŽ¥å¯¼å…¥æ±‡æ€»æ•°æ®ã€‚

### Q2: å¦‚æžœExcelä¸­çš„äº§å“ç¼–ç åœ¨æ•°æ®åº“ä¸­ä¸å­˜åœ¨æ€Žä¹ˆåŠž?

**A**: ETLè„šæœ¬ä¼šè‡ªåŠ¨è·³è¿‡ä¸å­˜åœ¨çš„äº§å“ç¼–ç å¹¶è®°å½•è­¦å‘Šæ—¥å¿—ã€‚å¯¼å…¥å‰åº”ç¡®ä¿:
1. å…ˆå¯¼å…¥æˆæœ¬å¡æ•°æ®(æ–‡ä»¶2),å»ºç«‹productè¡¨
2. ç¡®ä¿é”€å”®Excelä¸­çš„äº§å“ç¼–ç ä¸Žproductè¡¨ä¸­çš„product_codeä¸€è‡´

### Q3: å›¢è´­å¥—é¤çš„å¹³å°ä½£é‡‘å¦‚ä½•è®¡ç®—?

**A**:
```
å¹³å°ä½£é‡‘ = å›¢è´­ä»· Ã— å¹³å°ä½£é‡‘çŽ‡
å‡€æ”¶å…¥ = å›¢è´­ä»· - å¹³å°ä½£é‡‘

ç¤ºä¾‹(ç¾Žå›¢):
å›¢è´­ä»·: 168å…ƒ
ä½£é‡‘çŽ‡: 8%
å¹³å°ä½£é‡‘: 168 Ã— 0.08 = 13.44å…ƒ
å‡€æ”¶å…¥: 168 - 13.44 = 154.56å…ƒ
```

ç³»ç»Ÿä¼šåœ¨sales_orderè¡¨ä¸­è‡ªåŠ¨è®¡ç®—platform_commission_amountå­—æ®µã€‚

### Q4: å¦‚ä½•å¤„ç†æ—¢æœ‰æŠ˜æ‰£åˆæœ‰å›¢è´­çš„è®¢å•?

**A**:
- å¦‚æžœæ˜¯ä½¿ç”¨å›¢è´­åˆ¸æ ¸é”€: `is_group_buy=TRUE`, å›¢è´­ä»·å³ä¸ºfinal_amount
- å¦‚æžœå›¢è´­åˆ¸ä¸Šå†æ‰“æŠ˜: `discount_amount`è®°å½•é¢å¤–æŠ˜æ‰£, `final_amount`ä¸ºæœ€ç»ˆå®žæ”¶

**å»ºè®®**: å›¢è´­æ´»åŠ¨é€šå¸¸ä¸å†å åŠ æŠ˜æ‰£,ä¿æŒå›¢è´­ä»·ä¸ºæœ€ç»ˆä»·ã€‚

### Q5: å¤–å–è®¢å•çš„å¹³å°ä½£é‡‘çŽ‡æ˜¯å¤šå°‘?

**A**:
- ç¾Žå›¢å¤–å–: é€šå¸¸18%-22%
- æŠ–éŸ³å¤–å–: é€šå¸¸6%-8%
- é¥¿äº†ä¹ˆ: é€šå¸¸18%-20%

**æ³¨æ„**: å¤–å–å’Œå›¢è´­çš„ä½£é‡‘çŽ‡ä¸åŒã€‚éœ€è¦åœ¨group_buy_platformè¡¨ä¸­æ­£ç¡®é…ç½®ã€‚

### Q6: å¦‚ä½•æŸ¥çœ‹æŸä¸ªå›¢è´­æ´»åŠ¨çš„é”€å”®æ•ˆæžœ?

**A**:
```sql
SELECT * FROM v_groupbuy_deal_performance
WHERE deal_code = 'GB-MT-001';
```

ä¼šæ˜¾ç¤º:
- å·²å”®æ•°é‡ã€é”€å”®çŽ‡
- æ€»è¥æ”¶ã€å‡€æ”¶å…¥
- å¹³å°ä½£é‡‘é‡‘é¢å’Œæ¯”ä¾‹
- æ´»åŠ¨è¿›è¡Œå¤©æ•°

---

## é™„å½•: å­—æ®µæ˜ å°„å¯¹ç…§è¡¨

### POSç³»ç»Ÿ â†’ æ•°æ®åº“å­—æ®µæ˜ å°„

| POSç³»ç»Ÿå­—æ®µ | æ•°æ®åº“è¡¨ | æ•°æ®åº“å­—æ®µ | æ•°æ®ç±»åž‹ | è¯´æ˜Ž |
|-----------|---------|-----------|---------|------|
| è®¢å•ç¼–å· | sales_order | order_code | VARCHAR(50) | ä¸»é”® |
| è®¢å•æ—¥æœŸæ—¶é—´ | sales_order | order_datetime | TIMESTAMP | ç²¾ç¡®ä¸‹å•æ—¶é—´ |
| æ¡Œå· | sales_order | table_number | VARCHAR(20) | å ‚é£Ÿå¿…å¡« |
| å°±é¤äººæ•° | sales_order | guest_count | INT | é»˜è®¤1 |
| å…¥åº§æ—¶é—´ | sales_order | seat_time | TIMESTAMP | å¯é€‰ |
| ç¦»åº§æ—¶é—´ | sales_order | leave_time | TIMESTAMP | å¯é€‰ |
| è®¢å•ç±»åž‹ | sales_order | order_type | VARCHAR(20) | æžšä¸¾å€¼ |
| é”€å”®æ¸ é“ | sales_order | sales_channel | VARCHAR(50) | æžšä¸¾å€¼ |
| æ”¯ä»˜æ–¹å¼ | sales_order | payment_method | VARCHAR(50) | æžšä¸¾å€¼ |
| å¹³å°è®¢å•å· | sales_order | platform_order_id | VARCHAR(100) | ç¬¬ä¸‰æ–¹å¹³å°ID |
| äº§å“ç¼–ç  | sales_order_item | product_code | VARCHAR(50) | å…³è”product |
| äº§å“åç§° | sales_order_item | product_name | VARCHAR(200) | å†—ä½™å­—æ®µ |
| æ•°é‡ | sales_order_item | quantity | DECIMAL(10,2) | é”€å”®æ•°é‡ |
| å•ä»· | sales_order_item | unit_price | DECIMAL(10,2) | åŽŸä»· |
| æŠ˜æ‰£çŽ‡ | sales_order_item | discount_rate | DECIMAL(5,4) | 0-1ä¹‹é—´ |
| å®žé™…å•ä»· | sales_order_item | actual_price | DECIMAL(10,2) | æŠ˜åŽä»· |

---

**ç‰ˆæœ¬åŽ†å²**:
- v2.0.0-order-extension (2025-11-21): åˆå§‹ç‰ˆæœ¬,è®¢å•ç³»ç»Ÿæ‰©å±•
- å¯¹åº”æ•°æ®åº“ç‰ˆæœ¬: v1.0.0-mvp + order-extension

**ç›¸å…³æ–‡æ¡£**:
- åŸºç¡€æ•°æ®å½•å…¥: `æ•°æ®å½•å…¥è§„åˆ™ä¸Žè¿ç§»æŒ‡å—.md`
- æ•°æ®åº“æž¶æž„: `CLAUDE.md`
- MVPå¿«é€Ÿå…¥é—¨: `README_MVP_CN.md`
